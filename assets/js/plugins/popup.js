!function(t){var a,i;i={init:function(a,i){return this.options=t.extend({},this.options,a),this.elem=i,this.$elem=t(i),this.$body=t("body"),this.handlers(),this},options:{width:"5em",height:"5em",bodyClass:"popup-body",containerClass:"popup-shader",popupClass:"popup",popupCloseClass:"popup-close",content:"pop-content",contentWrapperClass:"popup-content",titleClass:"popup-title",loadingAnimation:!0,loader:"<div class='spinner'><div>Loading<div/></div>"},handlers:function(){var t=this;return this.$elem.on("click",function(a){a.preventDefault(),t.build()}),this},build:function(){var a,i=this;return void 0!==this.$elem.data("pop-size")&&(a=this.$elem.data("pop-size").split(","),this.options.width=a[0],this.options.height=a[1]),this.data={},this.data.dir=0,void 0!==this.$elem.data("pop-type")?this.data.type=this.$elem.data("pop-type"):console.log("Please specify 'data-pop-type' attribute"),this.construct(),this.atach(),this.$body.on("click.cleaning","."+this.options.containerClass,function(a){t(a.target).is("."+i.options.containerClass)&&i.clean()}),t(document).on("keyup.cleaning",function(t){27===t.which&&i.clean()}),this},atach:function(){return this.data.content&&(this.data.content.prependTo(this.data.wrapper),"image"===this.data.type&&(this.data.title.prependTo(this.data.wrapper),this.data.galleryNext.prependTo(this.data.wrapper),this.data.galleryPrev.prependTo(this.data.wrapper),this.data.status.prependTo(this.data.wrapper)),this.data.wrapper.prependTo(this.data.popup),this.data.popupClose.prependTo(this.data.popup).on("click",t.proxy(this.clean,this)),this.data.popup.prependTo(this.data.container),this.$body.prepend(this.data.container).addClass(this.options.bodyClass)),this},construct:function(){var a;this.data.docHeight=this.$body.height(),this.data.winHeight=t(window).height(),this.data.docWidth=this.$body.width(),this.data.winWidth=t(window).width(),this.data.container=t("<div>").addClass(this.options.containerClass),this.data.popup=t("<div>").addClass(this.options.popupClass).width(this.options.width).height(this.options.height),this.data.popupClose=t("<div>").addClass(this.options.popupCloseClass),this.data.wrapper=t("<div class='"+this.options.contentWrapperClass+"'>"),this.data.title=t("<div class='"+this.options.titleClass+"'>").text(this.$elem.data("pop-title")),"image"===this.data.type&&(this.data.gallery=t("img.popup-trigger"),this.data.galleryLength=this.data.gallery.length,this.data.galleryImgIndex=this.indexFinder(this.elem),this.data.galleryNext=t("<div class='popup-next'>").on("click",a=this,function(){return a.data.dir=1,a.gallery()}),this.data.galleryPrev=t("<div class='popup-prev'>").on("click",a=this,function(){return a.data.dir=-1,a.gallery()}),this.data.status=t("<div class='popup-status'>")),void 0!==this.$elem.data(this.options.content)?this.data.content=this.content():console.log("Please specify 'data-pop-content' attribute")},gallery:function(){var a,i;return this.data.galleryImgIndex+=this.data.dir,a=t(this.data.gallery[this.data.galleryImgIndex]).data("pop-content"),i=t(this.data.gallery[this.data.galleryImgIndex]).data("pop-title"),this.data.title.text(i),this.data.status.html("<strong>"+(this.data.galleryImgIndex+1)+"</strong>/"+this.data.galleryLength),this.imageLoader(a),this.data.galleryImgIndex===this.data.galleryLength-1?this.data.galleryNext.addClass("popup-next--disabled"):0===this.data.galleryImgIndex?this.data.galleryPrev.addClass("popup-prev--disabled"):(this.data.galleryPrev.removeClass("popup-prev--disabled"),this.data.galleryNext.removeClass("popup-next--disabled"))},indexFinder:function(t){var a;return a=0,this.data.gallery.each(function(i,e){t===e&&(a=i)}),a},imageLoader:function(a){var i;return t("<img>",{src:a}).load(i=this,function(){return i.image(this)}),this.options.loadingAnimation?t("<div/>",{"class":".popup-animation"}).appendTo(".popup-shader"):void 0},content:function(){switch(this.data.type){case"html":return t(this.$elem.data(this.options.content)).removeClass("is-none");case"iframe":return t("<iframe>",{src:this.$elem.data(this.options.content),seamless:"seamless",frameborder:0,style:"background-color: transparent;border: 0px none transparent;padding: 0px;overflow: hidden;",width:"100%",height:"100%"});case"ajax":return console.log("Ajax content");case"image-gallery":return this.gallery();case"image":if(imgsrc=this.$elem.data(this.options.content),t("<img>",{src:imgsrc}).load(_this=this,function(){return _this.image(this)}),this.options.loadingAnimation)return t("<div/>",{"class":"popup-loader"}).html(this.options.loader);break;default:return console.log("Please specify attribute 'data-pop-type'")}},clean:function(){return this.$body.removeClass(this.options.bodyClass),this.$body.off(".cleaning"),"html"===this.data.type&&this.data.content.appendTo("body").addClass("is-none"),this.data.container.remove(),this},image:function(a){var i,e,s,o,n,d,p,h,r,l,c,g,u,m,y,v,f,b;for(t(".popup-loader").remove(),i=t(a).css("display","block"),this.data.wrapper.find("img").remove(),this.data.wrapper.prepend(i).css("overflow","visible"),this.data.popup.css("opacity","0"),d=["padding-left","padding-right","border-left-width","border-right-width"],p=["padding-top","padding-bottom","border-top-width","border-bottom-width"],s=[this.data.popup,this.data.wrapper],o=0,h=0,c=0,y=d.length;y>c;c++)for(n=d[c],g=0,v=s.length;v>g;g++)e=s[g],o+=parseInt(e.css(n),10);for(u=0,f=p.length;f>u;u++)for(n=p[u],m=0,b=s.length;b>m;m++)e=s[m],h+=parseInt(e.css(n),10);return l=i[0].clientWidth+o,r=i[0].clientHeight+h,r>.95*this.data.winHeight&&(r="97%",l+=_h.getScrollbarWidth(),i.css({"max-height":"100%",margin:"auto"})),l>.95*this.data.winWidth&&(l="97%",i.css({"max-width":"100%"})),this.data.popup.animate({width:l,height:r,opacity:"1"},200,"linear"),this}},a="popify",t.fn[a]=function(e){return this.length?this.each(function(){return t.data(this,a)?void 0:t.data(this,a,Object.create(i).init(e,this))}):void 0}}(jQuery);